# Step by step guide
Here, we will go through every detail behind the various scripts step by step. In summary, there are four main steps here:

1. Theoretical prediction,
2. Generate meshes and convert their format,
3. Run FEM simulations on the meshes,
4. Analyse the data generated by the FEM simulations. 

In order to be able to conduct these steps, you must have installed the two conda environments "*fenicsproject*" and "*gmsh\_latest\_version*" (see the file with local path "../README.md"). Other than that, you must have installed Python as well as the two Python libraries *numpy* and *matplotlib*.  

# 1. Theoretical prediction
We will consider the following parameters of the Schnakenberg model: (a,b,gamma,d)=((0.20,1.00,20.00,6.87). These parameters isolate the eigenmode n=1. 

Interestingly, Bandle et al. [1] have derived a theoretical formula for how the perturbed eigenvalue of the Laplace-Beltrami operator is affected when a hole is added on the south pole. To plot the perturbed eigenvalues as a function of the radius of the hole, run the following script:<br>

*python find\_parameters\_and\_plot\_perturbed\_eigenvalues.py*

. Then, the figure below will be generated. 

![Perturbed eigenvalues](../Figures/perturbed_eigenvalues_n_1.png)
What this figure tells us is there is always at least one eigenvalue corresponding to n=1 the intervall indicated by the dashed lines denoted by M and L. In turn, this leads to the following rather striking conclusion: *the patterns are unaffected by the introduction of a hole in the sphere*. 

Next, we wish to validate this theoretical prediction by running FEM simulations. In order to be able to run these simulations, we first need to generate some meshes of spheres which have a single hole of varying size located at the south pole.
 
# 2. Generate meshes and convert their format
If you look into the folder with path "../Meshes" you see that it is empty with the exception of the README.md file. To this end, we want to fill this folder with numerous meshes so that we can run FEM simulations on these meshes. Concretely, we want to do two things:

1. Generate meshes of numerous spheres with a single hole located at the south pole using Gmsh,
2. Convert the format of these meshes so that they can be read by FEniCS.

## 2.1 Generate meshes of numerous spheres with a single hole located at the south pole using Gmsh
Begin by activating the conda environment "*gmsh\_latest\_version*":

*conda activate gmsh\_latest\_version*<br>

or alternatively (if this does not work)<br>

*source activate gmsh\_latest\_version*<br>

. Next, let's look at an example of the type of mesh we want to generate by running the script<br>

*python visualise\_spherical\_mesh\_with\_hole.py*<br>

. If Gmsh works properly, a graphical interface will be opened. In this interface you can click on "*Tools->Options->Mesh*" and then check the box "*2D element faces*" and you will see what the mesh looks like. Sometimes there are some issues with the graphical interface of Gmsh, but this is not the end of the world as you can normally still generate the meshes. As you can see in this script, the meshes are generated by intersecting a cylinder of radius r with the unit sphere at the south pole (0,0,-1) and then we remove the intersection between these surfaces. 

Next, we would like to generate 15 meshes where the cylindrical radii of the single hole located at the south pole are given by r=0,0.05,0.10,...,0.70. This is achieved by running the script

*python generate\_spherical\_meshes\_with\_holes.py*<br>

. After this script has terminated, you can now see that we have 15 meshes in the folder "../Meshes/" which are stored in the format with suffix ".msh". To get an idea of what these meshes look like, see the figure below. 

![Meshes of the unit sphere with a single hole located at the south pole](../Figures/Meshes_growing_radii.png)
Now, we have generated the meshes using Gmsh, and next we need to convert these meshes into another format that can be read by FEniCS which we will use to run FEM simulations on these meshes. To this end, we exit the current conda environment by typing<br>

*conda deactivate*<br>

and next we will convert the format of these meshes.



## 2.2 Convert the format of these meshes so that they can be read by FEniCS

# 3. Run FEM simulations on the meshes


# 4. Analyse the data generated by the FEM simulations 


# References
[1] C. Bandle, Y. Kabeya, and H. Ninomiya, “Bifurcating solutions of a nonlinear elliptic
neumann problem on large spherical caps,” Funkcialaj Ekvacioj, vol. 62, pp. 285–317,
2019.
